{% extends 'base.html' %}
{% block content %}

<h2>Create or Update Course Info</h2>

<form method="POST">
  {% csrf_token %}

  <label for="id_course">Course:</label>
  {{ form.course }}
  <br>

 
  <label for="id_teacher">Teacher:</label>
  {{ form.teacher }}
  <br>



  <label for="id_year">Year:</label>
  {{ form.year }}
  <br>
  

  <label for="id_semester">Semester:</label>
  {{ form.semester }}
  <br>


 
  <label for="id_class_name">Class Name:</label>
  {{ form.class_name }}
  <br>


  
  <label for="id_capacity">Capacity:</label>
  {{ form.capacity }}
  <br>



  <label for="id_session_type">Session Type:</label>
  <select name="session_type" id="id_session_type" onchange="calculateEndTime()">
    <option value="lecture" {% if form.session_type.value == 'lecture' %}selected{% endif %}>Lecture (50 min)</option>
    <option value="lab" {% if form.session_type.value == 'lab' %}selected{% endif %}>Lab (100 min)</option>
  </select>
  <br>


  <label for="id_days">Days:</label>
  {{ form.days }}
  <br>



  <label for="id_status">Status:</label>
  {{ form.status }}
  <br>


  
  <label for="id_start_time">Start Time:</label>
  <input type="time" name="start_time" id="id_start_time" value="{{ form.start_time.value|default_if_none:'' }}" onchange="calculateEndTime()" required>
  <br>

  <label for="id_start_time">End Time:</label>
  <input type="time" name="end_time" id="id_end_time" required>
  <br>





  <br><br>
  <button type="submit">Save Course Info</button>
</form>


<script>
function calculateEndTime() {
    const sessionType = document.getElementById('id_session_type').value;
    const startTime = document.getElementById('id_start_time').value;

    if (!startTime) return;

    let [hour, minute] = startTime.split(':').map(Number);
    let addMinutes = sessionType === 'lab' ? 100 : 50;

    minute += addMinutes;
    hour += Math.floor(minute / 60);
    minute = minute % 60;

    const endHour = String(hour).padStart(2, '0');
    const endMinute = String(minute).padStart(2, '0');
    const endTime = `${endHour}:${endMinute}`;

    document.getElementById('id_end_time').value = endTime;
}
</script>

{% endblock %}
